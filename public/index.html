<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>theacademy - Acceso al chat</title>
    <link rel="stylesheet" href="/style.css" />
    <script src="/socket.io/socket.io.js"></script>
  </head>

  <body>
    <main class="app-shell">
      <section class="chat-column">
        <header class="brand">
          <div class="logo-circle" aria-hidden="true">ta</div>
          <div>
            <h1>theacademy</h1>
            <p class="subtitle">Conectamos clientes, cajeros y administraci√≥n.</p>
          </div>
        </header>

        <section id="accessCard" class="card-block access-card">
          <h2>Bienvenido</h2>
          <p class="muted">¬øYa tienes un usuario (NICK) asignado?</p>
          <div class="access-options">
            <button type="button" class="primary-button" data-choice="login">S√≠, iniciar sesi√≥n</button>
            <button type="button" class="secondary-button" data-choice="register">No, soy nuevo</button>
          </div>
        </section>

        <section id="loginSection" class="card-block auth-card" hidden>
          <header class="section-header">
            <h2>Ingreso con usuario</h2>
            <button id="loginBackButton" class="text-button" type="button">&larr; Volver</button>
          </header>
          <p class="muted">
            Ingresa tu usuario (NICK) y contrase√±a para retomar la conversaci√≥n con nuestro equipo.
          </p>
          <form id="loginForm" class="form-block" autocomplete="on">
            <label for="loginNick">Usuario (NICK)</label>
            <div class="input-group">
              <span class="input-prefix">üë§</span>
              <input id="loginNick" name="nick" placeholder="Ej. juanperez" autocomplete="username" required />
            </div>
            <label for="loginPassword">Contrase√±a</label>
            <div class="input-group">
              <span class="input-prefix">üîë</span>
              <input
                id="loginPassword"
                name="password"
                type="password"
                autocomplete="current-password"
                placeholder="Ingresa tu contrase√±a"
                required
              />
            </div>
            <div class="form-actions">
              <button class="primary-button" type="submit">Ingresar</button>
            </div>
          </form>
        </section>

        <section id="chatSection" class="chat card-block" hidden>
          <header class="chat-header">
            <div class="chat-contact">
              <div class="avatar" aria-hidden="true">üí¨</div>
              <div>
                <h2 id="chatTitle">Cajero virtual</h2>
                <p id="chatSubtitle" class="verified"></p>
              </div>
            </div>
            <button class="secondary-button" id="logoutButton" type="button">Cerrar sesi√≥n</button>
          </header>

          <div class="chat-body">
            <div id="messages" class="messages" role="log" aria-live="polite">
              <div class="empty-state">
                <div class="empty-icon">üí°</div>
                <p>Selecciona una acci√≥n r√°pida o escribe tu consulta para comenzar.</p>
              </div>
            </div>
          </div>

          <form id="chatForm" class="chat-form" autocomplete="off">
            <input id="messageInput" name="mensaje" placeholder="Escribe un mensaje" required />
            <button class="primary-button" type="submit">Enviar</button>
          </form>
        </section>
      </section>

      <aside class="support-column">
        <section class="card-block quick-actions">
          <h2>Acciones r√°pidas</h2>
          <p class="muted">Selecciona una opci√≥n para comenzar la conversaci√≥n.</p>
          <div class="action-grid">
            <button class="action-button" type="button" data-message-template="Hola, me gustar√≠a solicitar fichas.">
              Solicitar fichas
            </button>
            <button class="action-button" type="button" data-message-template="Hola, quiero solicitar mi recompensa.">
              Solicitar recompensa
            </button>
            <button class="action-button" type="button" data-message-template="Hola, necesito soporte con mi cuenta.">
              Solicitar soporte
            </button>
          </div>
        </section>

        <section class="card-block platform-links-card">
          <h2>Plataformas disponibles</h2>
          <p id="platformLinksStatus" class="muted">Cargando enlaces...</p>
          <ul id="platformLinksList" class="platform-links" aria-live="polite"></ul>
        </section>
      </aside>
    </main>

    <div id="alerts" class="alerts" role="status" aria-live="polite"></div>

    <div id="verificationOverlay" class="overlay" hidden>
      <div class="overlay-card" role="dialog" aria-modal="true">
        <header class="overlay-header">
          <h2>Validaci√≥n de celular</h2>
          <button id="closeOverlayButton" class="icon-button" type="button" aria-label="Cerrar">‚úï</button>
        </header>
        <p class="muted">
          Validamos tu n√∫mero de celular para crear un NICK temporal. M√°s adelante, un cajero asignar√° tu usuario definitivo.
        </p>

        <form id="phoneForm" class="form-block" autocomplete="off">
          <label for="phoneInput">N√∫mero de tel√©fono</label>
          <div class="input-group">
            <span class="input-prefix">üì±</span>
            <input
              id="phoneInput"
              name="phone"
              type="tel"
              inputmode="tel"
              placeholder="Ej. +5491124098501"
              required
            />
          </div>
          <p class="help">Recibir√°s un SMS con un c√≥digo de 6 d√≠gitos.</p>
          <button class="primary-button" type="submit">Enviar c√≥digo</button>
        </form>

        <form id="codeForm" class="form-block" hidden autocomplete="one-time-code">
          <label for="codeInput">C√≥digo de verificaci√≥n</label>
          <div class="input-group">
            <span class="input-prefix">üîê</span>
            <input
              id="codeInput"
              name="code"
              inputmode="numeric"
              pattern="\d{6}"
              maxlength="6"
              placeholder="Ingresa los 6 d√≠gitos"
              required
            />
          </div>
          <p class="help">Revisa tu SMS e ingresa el c√≥digo recibido.</p>
          <div class="form-actions">
            <button class="secondary-button" type="button" id="resendButton">Reenviar c√≥digo</button>
            <button class="primary-button" type="submit">Validar c√≥digo</button>
          </div>
        </form>
      </div>
    </div>

    <script type="module" src="/script.js"></script>
  </body>
</html>
